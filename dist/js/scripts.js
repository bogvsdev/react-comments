var wait,_methods={},_comments=[],Store,Actions,Flux=new McFly;localforage.setDriver([localforage.INDEXEDDB,localforage.LOCALSTORAGE]),wait=setInterval(function(){localforage.getItem("comments").then(function(e){null!=e&&(e.forEach(function(e){null!=e&&(Actions.addComment(e,!1),_comments.push(e))}),clearInterval(wait))})},100),Store=Flux.createStore({getComments:function(){return _comments}},function(e){switch(e.actionType){case"ADD_COMMENT":_methods.addComment(e.commentData,e.state),Store.emitChange()}}),Actions=Flux.createActions({addComment:function(e,t){return{actionType:"ADD_COMMENT",commentData:e,state:t}}}),_methods.addComment=function(e,t){if(_comments.push(e),t){var n=_comments.reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[]);_comments=n,localforage.setItem("comments",_comments)}},_methods.getComments=function(){return Store.getComments()};var CommentForm=React.createClass({displayName:"CommentForm",saveComment:function(e){e.preventDefault();var t,n,a,m,o,c=!1;t=++_methods.getComments().length,n=React.findDOMNode(this.refs.name).value,a=React.findDOMNode(this.refs.email).value,m=React.findDOMNode(this.refs.text).value,c=n.length>0&&a.length>0&&m.length>0?!0:!1,c&&(o={id:t,author:n,email:a,text:m},Actions.addComment(o,!0),this.clearFields())},clearFields:function(){React.findDOMNode(this.refs.name).value="",React.findDOMNode(this.refs.email).value="",React.findDOMNode(this.refs.text).value=""},render:function(){return React.createElement("form",{id:"add-comment-form",onSubmit:this.saveComment},React.createElement("h3",null,"Share your opinion"),React.createElement("p",null,React.createElement("input",{className:"comment-input",type:"text",maxlength:"20",ref:"name",required:!0,placeholder:"Enter your name"}),React.createElement("input",{className:"comment-input",type:"email",ref:"email",required:!0,placeholder:"Enter your email"})),React.createElement("p",null,React.createElement("textarea",{id:"comment-area",ref:"text",required:!0,placeholder:"Enter your comment here"})),React.createElement("p",null,React.createElement("input",{id:"comment-btn",type:"submit",value:"Publish"})))}}),Comments=React.createClass({displayName:"Comments",mixins:[Store.mixin],getInitialState:function(){return{comments:_methods.getComments()}},storeDidChange:function(){this.setState({cats:_methods.getComments()})},render:function(){var e,t=this.state.comments;return e=t.length>0?t.map(function(e){return React.createElement("div",{key:e.id,id:"com-"+e.id,className:"comment"},React.createElement("p",{"data-author":e.author,className:"comment-content"},e.text))}):React.createElement("h4",null,"There is no comments :("),React.createElement("div",null,e,React.createElement(CommentForm,null))}});React.render(React.createElement(Comments,null),document.querySelector(".comment-block"));
console.log("app is working...");